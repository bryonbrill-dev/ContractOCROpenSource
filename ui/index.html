<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ContractOCR UI</title>
  <script>
    tailwind = window.tailwind || {};
    tailwind.config = { corePlugins: { preflight: false } };
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f1f5f9; color: #0f172a; }
    body.theme-dark { background: #0f172a; color: #e2e8f0; }
    .row { display: flex; gap: 16px; }
    .row.wrap { flex-wrap: wrap; }
    .col { flex: 1; }
    .card { border: 1px solid #dbe2f0; border-radius: 10px; padding: 12px; background: #fff; box-shadow: 0 2px 10px rgba(15, 23, 42, 0.06); }
    .drop { border: 2px dashed #94a3b8; border-radius: 10px; padding: 18px; text-align: center; cursor: pointer; background: #f8fafc; }
    .drop.drag { background: #f3f6ff; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border-bottom: 1px solid #eee; padding: 8px; text-align: left; }
    .badge { padding: 3px 8px; border-radius: 999px; color: #fff; font-size: 12px; display: inline-block; }
    .green { background: #2e7d32; }
    .red { background: #c62828; }
    .yellow { background: #b26a00; }
    .muted { color: #666; font-size: 12px; }
    input, button, select { padding: 8px; }
    input, select { border: 1px solid #111; border-radius: 6px; background: #fff; }
    input:focus, select:focus { outline: 2px solid #111; outline-offset: 1px; }
    button { cursor: pointer; background: #0b3a6f; color: #fff; border: 1px solid #0b3a6f; border-radius: 6px; font-weight: 600; }
    button:hover { background: #f28c28; border-color: #f28c28; color: #fff; }
    button:focus { outline: 2px solid #ffffff; outline-offset: 1px; box-shadow: 0 0 0 3px rgba(11, 58, 111, 0.35); }
    a { text-decoration: underline; color: #1d4ed8; font-weight: 600; }
    .small { font-size: 12px; }
    pre { white-space: pre-wrap; word-break: break-word; }
    .hidden { display: none; }
    .nav { display: flex; gap: 10px; margin: 12px 0; }
    .nav button { border: 1px solid #0b3a6f; background: #ffffff; color: #0b3a6f; padding: 10px 14px; border-radius: 6px; font-weight: bold; }
    .nav button:hover { background: #f28c28; border-color: #f28c28; color: #ffffff; }
    .nav button.active { background: #0b3a6f; border-color: #0b3a6f; color: #ffffff; }
    .folder-list { display: flex; flex-direction: column; gap: 12px; margin-top: 10px; }
    .folder-card { border: 1px solid #dce1ff; border-radius: 10px; background: linear-gradient(135deg, #f8f9ff, #ffffff); box-shadow: 0 1px 4px rgba(0,0,0,0.06); }
    .folder-header { display: flex; justify-content: space-between; align-items: center; padding: 12px 14px; border-bottom: 1px solid #e6e9ff; }
    .folder-title { font-weight: bold; font-size: 16px; }
    .folder-body { padding: 10px 14px 12px 14px; border-left: 4px solid #c4cdfc; }
    .event-row { display: flex; gap: 12px; padding: 8px 6px; border-bottom: 1px dashed #e6e9ff; align-items: center; }
    .event-row:last-child { border-bottom: none; }
    .event-date { min-width: 110px; font-weight: bold; color: #2e3b8b; }
    .pill { background: #eef2ff; color: #2e3b8b; padding: 4px 8px; border-radius: 999px; font-size: 11px; border: 1px solid #d0d7ff; }
    .event-type { background: #e3f2fd; color: #1565c0; border-color: #bbdefb; }
    .status-smart { background: #dcfce7; color: #166534; border-color: #86efac; }
    .status-manual { background: #fef3c7; color: #92400e; border-color: #fcd34d; font-weight: 700; }
    .status-inconclusive { background: #fee2e2; color: #991b1b; border-color: #fecaca; }
    .event-renewal { background: #ede9fe; color: #5b21b6; border-color: #c4b5fd; }
    .event-termination { background: #ffe4e6; color: #9f1239; border-color: #fecdd3; }
    .event-effective { background: #e0f2fe; color: #075985; border-color: #bae6fd; }
    .event-auto_opt_out { background: #fef3c7; color: #92400e; border-color: #fcd34d; }
    .legend { border: 1px solid #e5e7eb; border-radius: 8px; padding: 10px; background: #f8fafc; margin-top: 10px; }
    .legend-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 8px; margin-top: 8px; }
    .legend-item { display: flex; align-items: center; gap: 8px; font-size: 12px; color: #374151; }
    .filters label { display: flex; flex-direction: column; gap: 4px; font-size: 12px; color: #444; }
    .section { border: 1px solid #e5e7eb; border-radius: 8px; padding: 10px; margin-top: 10px; background: #f8fafc; }
    details.section { padding: 8px 10px; }
    details.section > summary { cursor: pointer; list-style: none; display: flex; align-items: center; gap: 10px; }
    details.section > summary::-webkit-details-marker { display: none; }
    details.section > summary::marker { content: ""; }
    details.legend > summary { cursor: pointer; list-style: none; display: flex; align-items: center; gap: 10px; }
    details.legend > summary::-webkit-details-marker { display: none; }
    details.legend > summary::marker { content: ""; }
    .summary-chevron { font-size: 25px; color: #64748b; transition: transform 0.2s ease; }
    details.section[open] > summary .summary-chevron,
    details.legend[open] > summary .summary-chevron { transform: rotate(90deg); }
    .summary-title { display: flex; align-items: center; gap: 6px; flex-wrap: wrap; font-weight: bold; font-size: 13px; }
    .summary-meta { display: inline-flex; align-items: center; gap: 8px; font-size: 13px; color: #6b7280; font-weight: normal; margin-left: auto; }
    .pill.tag { border-color: transparent; }
    .section h4 { margin: 0 0 6px 0; }
    .inline { display: inline-flex; gap: 8px; align-items: center; flex-wrap: wrap; }
    .muted-input { width: 100%; box-sizing: border-box; }
    .chip-btn { background: none; border: none; cursor: pointer; color: #b91c1c; margin-left: 6px; }
    .link-button { background: none; border: none; color: #1d4ed8; cursor: pointer; font-weight: 600; padding: 0; }
    .link-button:hover { text-decoration: underline; }
    .info-icon { display: inline-flex; align-items: center; justify-content: center; width: 16px; height: 16px; border-radius: 999px; border: 1px solid #94a3b8; color: #475569; font-size: 11px; line-height: 1; cursor: help; }
    .label-with-info { display: inline-flex; align-items: center; gap: 6px; }
    .preview-grid { display: grid; gap: 12px; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); }
    .preview-pane { height: 630px; min-height: 630px; resize: vertical; overflow: auto; }
    .preview-frame { width: 100%; height: 100%; border: 1px solid #e5e7eb; border-radius: 8px; background: #fff; }
    .contract-text { height: 630px; min-height: 630px; resize: vertical; overflow: auto; background: #fff; border: 1px solid #e5e7eb; border-radius: 8px; padding: 10px; font-size: 12px; }
    .preview-fullscreen { overflow: hidden; }
    .preview-fullscreen .contracts-layout { grid-template-columns: minmax(0, 1fr); }
    .preview-fullscreen .contracts-right { display: none; }
    .preview-fullscreen #detail > :not(#contractContent) { display: none; }
    .preview-fullscreen #contractContent { position: fixed; inset: 20px; margin: 0; z-index: 1000; background: #f8fafc; box-shadow: 0 12px 32px rgba(15, 23, 42, 0.2); overflow: auto; }
    .preview-fullscreen #contractContent .preview-grid { grid-template-columns: repeat(auto-fit, minmax(360px, 1fr)); }
    .preview-fullscreen .preview-pane,
    .preview-fullscreen .contract-text { height: calc(100vh - 220px); min-height: 0; }
    .expired-bell { display: inline-flex; align-items: center; gap: 4px; padding: 2px 6px; border-radius: 999px; background: #fee2e2; color: #b91c1c; font-size: 10px; font-weight: 700; }
    .planner-calendar { display: grid; grid-template-columns: repeat(7, minmax(0, 1fr)); gap: 1px; margin-top: 12px; border: 1px solid #e5e7eb; border-radius: 8px; overflow: visible; background: #e5e7eb; }
    .planner-cell { background: #ffffff; min-height: 110px; padding: 6px; display: flex; flex-direction: column; gap: 4px; }
    .planner-header { background: #f1f5f9; font-weight: 700; font-size: 12px; text-align: center; padding: 8px 6px; min-height: auto; }
    .planner-day { font-weight: 700; font-size: 12px; color: #1f2937; display: flex; justify-content: space-between; align-items: center; }
    .planner-day.muted { color: #9ca3af; font-weight: 600; }
    .planner-entry { display: flex; flex-direction: column; gap: 2px; padding: 4px 6px; border-radius: 6px; border: 1px solid #e2e8f0; background: #f8fafc; font-size: 11px; color: #1f2937; cursor: pointer; position: relative; }
    .planner-entry:focus { outline: 2px solid #1d4ed8; outline-offset: 2px; }
    .planner-entry:hover { box-shadow: 0 2px 6px rgba(15, 23, 42, 0.15); z-index: 2; }
    .planner-entry.event-renewal { background: #ede9fe; color: #5b21b6; border-color: #c4b5fd; }
    .planner-entry.event-termination { background: #ffe4e6; color: #9f1239; border-color: #fecdd3; }
    .planner-entry.event-effective { background: #e0f2fe; color: #075985; border-color: #bae6fd; }
    .planner-entry.event-auto_opt_out { background: #fef3c7; color: #92400e; border-color: #fcd34d; }
    .planner-entry[data-tooltip]::after { content: attr(data-tooltip); position: absolute; left: 0; top: 100%; margin-top: 6px; background: #111827; color: #f9fafb; padding: 6px 8px; border-radius: 6px; font-size: 11px; line-height: 1.4; white-space: pre-line; width: max-content; max-width: 240px; z-index: 20; opacity: 0; transform: translateY(4px); pointer-events: none; box-shadow: 0 6px 12px rgba(15, 23, 42, 0.2); }
    .planner-entry:hover::after,
    .planner-entry:focus::after { opacity: 1; transform: translateY(0); }
    .planner-entry .entry-title { font-weight: 600; }
    .planner-entry .entry-meta { font-size: 10px; color: #475569; }
    .planner-more { font-size: 10px; color: #2563eb; }
    .planner-empty { min-height: 20px; }
    .active-row { background: #fef9c3; }
    .manual-term > summary { background: #fffbeb; border: 1px solid #fde68a; border-radius: 6px; padding: 6px; }
    .event-date-group { background: #f8fafc; }
    .event-date-body { margin-top: 8px; display: flex; flex-direction: column; gap: 8px; }
    .event-contract-body { margin-top: 6px; border-left: 3px solid #c7d2fe; padding-left: 10px; }
    .danger { background: #dc2626; border-color: #dc2626; }
    .danger:hover { background: #b91c1c; border-color: #b91c1c; }
    .month-nav { display: inline-flex; gap: 6px; align-items: center; }
    .month-nav button { padding: 6px 8px; }
    .contracts-layout { display: grid; grid-template-columns: minmax(0, 2fr) minmax(0, 1fr); gap: 16px; align-items: start; }
    .contracts-right { display: flex; flex-direction: column; gap: 16px; }
    .compact-table th, .compact-table td { padding: 6px; font-size: 12px; }
    .compact-table th { white-space: nowrap; }
    .top-bar { display: flex; align-items: center; justify-content: space-between; gap: 12px; flex-wrap: wrap; }
    .theme-toggle { display: inline-flex; align-items: center; gap: 8px; }
    .theme-toggle button { background: #ffffff; color: #0b3a6f; border-color: #0b3a6f; }
    .theme-toggle button:hover { background: #f28c28; border-color: #f28c28; color: #ffffff; }
    body.theme-dark .card { background: #111827; border-color: #1f2937; box-shadow: 0 2px 10px rgba(15, 23, 42, 0.35); }
    body.theme-dark .drop { background: #0b1220; border-color: #475569; }
    body.theme-dark .nav button { background: #0f172a; color: #e2e8f0; border-color: #60a5fa; }
    body.theme-dark .nav button.active { background: #2563eb; border-color: #2563eb; color: #ffffff; }
    body.theme-dark input, body.theme-dark select { background: #0f172a; color: #e2e8f0; border-color: #475569; }
    body.theme-dark table th, body.theme-dark table td { border-bottom: 1px solid #1f2937; }
    body.theme-dark a { color: #93c5fd; }
    body.theme-dark .muted { color: #94a3b8; }
    body.theme-dark .section { background: #0b1220; border-color: #1f2937; }
    body.theme-dark .legend { background: #0b1220; border-color: #1f2937; }
    body.theme-dark .section ul { color: #cbd5f5; }
    body.theme-dark .planner-cell { background: #0f172a; }
    body.theme-dark .planner-header { background: #1e293b; }
    body.theme-dark .planner-entry { background: #111827; border-color: #1f2937; color: #e2e8f0; }
    body.theme-dark .contract-text { background: #0f172a; border-color: #1f2937; color: #e2e8f0; }
    body.theme-dark .preview-frame { background: #0f172a; border-color: #1f2937; }
    body.theme-dark.preview-fullscreen #contractContent { background: #0b1220; }
    body.theme-dark .event-date { color: #bfdbfe; }
    body.theme-dark #modalOverlay .bg-white { background: #0f172a; border-color: #1f2937; }
    body.theme-dark #modalOverlay .text-slate-900 { color: #e2e8f0; }
    body.theme-dark #modalOverlay .text-slate-600 { color: #94a3b8; }
    body.theme-dark #modalOverlay .text-slate-400 { color: #cbd5f5; }
    body.theme-dark #modalOverlay .border-slate-200 { border-color: #1f2937; }
    body.theme-dark #modalOverlay .hover\:bg-slate-50:hover { background: #1e293b; }
  </style>
</head>
<body>
  <div class="top-bar">
    <h2>ContractOCR</h2>
    <div class="theme-toggle">
      <span class="small muted" id="themeLabel">Theme: Light</span>
      <button id="themeToggle" type="button">Switch to Dark Theme</button>
    </div>
  </div>

  <div class="card">
    <div class="small muted">API Base</div>
    <input id="apiBase" style="width:360px" />
    <button id="saveApi">Save</button>
    <span class="muted small" id="apiStatus"></span>
  </div>

  <div class="nav">
    <button id="navContracts" class="active">Contracts</button>
    <button id="navAllContracts">All Contracts</button>
    <button id="navEvents">Events</button>
    <button id="navPlanner">Planner</button>
    <button id="navOutputs">Support Page</button>
  </div>

  <div id="contractsPage">
    <div class="contracts-layout" style="margin-top:16px">
      <div class="card">
        <h3 style="margin-top:0">Contract Detail</h3>
        <div id="detail" class="muted">Click a contract to view terms/events.</div>
      </div>

      <div class="contracts-right">
        <div class="card">
          <h3 style="margin-top:0">Upload</h3>
          <div id="drop" class="drop">Drag & drop PDF(s) here, or click to choose</div>
          <input id="filePicker" type="file" multiple accept=".pdf,.png,.jpg,.jpeg,.tif,.tiff" style="display:none" />
          <div id="uploadLog" class="small muted" style="margin-top:10px"></div>
        </div>
        <div class="card">
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <h3 style="margin:0">Recent Contracts</h3>
            <button id="refresh">Refresh</button>
          </div>
          <div class="muted small" style="margin-top:6px">Showing 5 most recent processed contracts.</div>
          <details class="legend">
            <summary class="small"><span class="summary-chevron" aria-hidden="true">▸</span><span class="summary-title">Color key</span></summary>
            <div class="legend-grid">
              <div class="legend-item"><span class="badge green">processed</span> Completed processing</div>
              <div class="legend-item"><span class="badge yellow">processing</span> OCR in progress</div>
              <div class="legend-item"><span class="badge red">error</span> Processing error</div>
              <div class="legend-item"><span class="pill status-smart">smart</span> High-confidence extraction</div>
              <div class="legend-item"><span class="pill status-manual">manual</span> Manually entered</div>
              <div class="legend-item"><span class="pill status-inconclusive">inconclusive</span> Low confidence</div>
              <div class="legend-item"><span class="pill event-type event-effective">effective</span> Key date</div>
              <div class="legend-item"><span class="pill event-type event-renewal">renewal</span> Renewal timeline</div>
              <div class="legend-item"><span class="pill event-type event-termination">termination</span> Termination date</div>
              <div class="legend-item"><span class="pill event-type event-auto_opt_out">auto opt-out</span> Notice deadline</div>
            </div>
            <div class="muted small" style="margin-top:6px;">Tag colors come from the tag settings.</div>
          </details>
          <table class="compact-table" style="margin-top:10px">
            <thead>
              <tr>
                <th>Status</th>
                <th>Title</th>
                <th>Uploaded</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="contracts"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <div id="eventsPage" class="hidden">
    <div class="card" style="margin-top:16px">
          <div style="display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap;">
            <div>
              <h3 style="margin:0">Upcoming Events</h3>
              <div class="muted small">Search and review renewal/termination timelines by date and contract.</div>
            </div>
            <div class="inline">
              <button id="eventsRefresh">Refresh</button>
              <button id="eventsExport">Export CSV</button>
            </div>
          </div>

          <div class="row wrap filters" style="margin-top:12px; gap:12px;">
            <label style="min-width:220px;">
              <span class="label-with-info">
                <span class="info-icon" title="Select a month to focus the event list. Use the arrows to move month by month.">i</span>
                <span>Show Month</span>
              </span>
              <div class="month-nav">
                <button type="button" id="eventPrevMonth">◀</button>
                <input id="eventMonth" type="month" />
                <button type="button" id="eventNextMonth">▶</button>
              </div>
            </label>
            <label style="min-width:140px; align-items:center; flex-direction:row; gap:8px; margin-top:18px;">
              <input type="checkbox" id="eventAllMonths" />
              Show all months
            </label>
            <label style="min-width:160px;">
              <span class="label-with-info">
                <span class="info-icon" title="Event types come from extracted terms and manual entries. Renewal/termination dates appear when the contract has a term length or specific date captured. Auto-renewing contracts without a term length may not show future renewals.">i</span>
                <span>Event Type</span>
              </span>
              <select id="eventTypeFilter">
                <option value="all">All types</option>
                <option value="renewal">Renewal</option>
            <option value="termination">Termination</option>
            <option value="auto_opt_out">Auto opt-out</option>
            <option value="effective">Effective</option>
          </select>
        </label>
        <label style="min-width:160px;">
          <span class="label-with-info">
            <span class="info-icon" title="Sort events by date or contract title.">i</span>
            <span>Sort</span>
          </span>
          <select id="eventSort">
            <option value="date_asc">Date ↑</option>
            <option value="date_desc">Date ↓</option>
            <option value="title_asc">Title A→Z</option>
            <option value="title_desc">Title Z→A</option>
          </select>
        </label>
        <label style="flex:1; min-width:200px;">
          <span class="label-with-info">
            <span class="info-icon" title="Search by contract title, vendor, or event type.">i</span>
            <span>Search contracts or event types</span>
          </span>
          <input id="eventSearch" type="text" placeholder="Search by contract, vendor, or event…" />
        </label>
        <label style="min-width:170px; align-items:center; flex-direction:row; gap:8px; margin-top:18px;">
          <input type="checkbox" id="expiringOnly" />
          <span class="label-with-info">
            <span class="info-icon" title="Filters to renewal, termination, and auto opt-out deadlines so evergreen contracts stay out of the list unless they have a defined notice or end date.">i</span>
            <span>Expiring-only</span>
          </span>
        </label>
      </div>

      <div class="muted small" id="eventsStatus" style="margin-top:4px"></div>
      <div id="eventsList" class="folder-list"></div>
    </div>
  </div>

  <div id="allContractsPage" class="hidden">
    <div class="card" style="margin-top:16px">
      <div style="display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap;">
        <div>
          <h3 style="margin:0">All Contracts</h3>
          <div class="muted small">Search across titles, vendors, and filenames.</div>
        </div>
        <div class="inline">
          <button id="allRefresh">Refresh</button>
          <button id="allContractsExport">Export CSV</button>
        </div>
      </div>

      <div class="row wrap filters" style="margin-top:12px; gap:12px;">
        <label style="flex:1; min-width:240px;">
          Search
          <input id="allContractsSearch" type="text" placeholder="Search contracts..." />
        </label>
        <label style="min-width:160px;">
          Status
          <select id="allContractsStatus"></select>
        </label>
        <label style="min-width:200px;">
          Contract Type
          <select id="allContractsType"></select>
        </label>
      </div>
      <div class="muted small" id="allContractsStatus" style="margin-top:4px"></div>
      <table style="margin-top:10px">
        <thead>
          <tr>
            <th>Status</th>
            <th>Title</th>
            <th>Vendor</th>
            <th>Contract Type</th>
            <th>Uploaded</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="allContractsTable"></tbody>
      </table>
      <div style="margin-top:10px;">
        <button id="allContractsLoadMore">Load more</button>
      </div>
    </div>
  </div>

  <div id="plannerPage" class="hidden">
    <div class="card" style="margin-top:16px">
      <div style="display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap;">
        <div>
          <h3 style="margin:0">Event Planner</h3>
          <div class="muted small">Add or edit renewal timelines and events for any contract.</div>
        </div>
        <div class="inline">
          <button id="plannerRefresh">Refresh</button>
          <button id="plannerExport">Export CSV</button>
        </div>
      </div>

      <div class="row wrap filters" style="margin-top:12px; gap:12px;">
        <label style="min-width:220px;">
          <span class="label-with-info">
            <span class="info-icon" title="Choose a month to populate the planner grid.">i</span>
            <span>Show Month</span>
          </span>
          <div class="month-nav">
            <button type="button" id="plannerPrevMonth">◀</button>
            <input type="month" id="plannerMonth" />
            <button type="button" id="plannerNextMonth">▶</button>
          </div>
        </label>
        <label style="min-width:170px; align-items:center; flex-direction:row; gap:8px; margin-top:18px;">
          <input type="checkbox" id="plannerAllMonths" />
          Show all months
        </label>
      </div>

      <div class="row wrap filters" style="margin-top:8px; gap:12px;">
        <label style="min-width:200px;">
          <span class="label-with-info">
            <span class="info-icon" title="Pick the contract to attach the new event to.">i</span>
            <span>Contract</span>
          </span>
          <select id="plannerContract"></select>
        </label>
        <label style="min-width:140px;">
          <span class="label-with-info">
            <span class="info-icon" title="Select the event type for the new planner entry.">i</span>
            <span>Event Type</span>
          </span>
          <select id="plannerEventType">
            <option value="renewal">Renewal</option>
            <option value="termination">Termination</option>
            <option value="effective">Effective</option>
            <option value="auto_opt_out">Auto opt-out</option>
            <option value="custom">Custom</option>
          </select>
        </label>
        <label style="min-width:160px;">
          <span class="label-with-info">
            <span class="info-icon" title="Select the date you want this event to appear on.">i</span>
            <span>Event Date</span>
          </span>
          <input type="date" id="plannerEventDate" />
        </label>
        <label style="flex:1; min-width:200px;">
          <span class="label-with-info">
            <span class="info-icon" title="Provide a custom label when Event Type is set to Custom.">i</span>
            <span>Custom Type (if chosen)</span>
          </span>
          <input type="text" id="plannerCustomType" placeholder="e.g., Notice" />
        </label>
        <button id="plannerAdd">Add Event</button>
      </div>

      <div class="muted small" id="plannerStatus" style="margin-top:4px"></div>
      <div class="section" style="margin-top:10px;">
        <h4>Monthly Planner Grid</h4>
        <div class="muted small">Shows events on the selected month. Abbreviated contract names appear on each day.</div>
        <div id="plannerCalendar" class="planner-calendar"></div>
      </div>
      <table style="width:100%; margin-top:10px; border-collapse:collapse;">
        <thead>
          <tr>
            <th>Contract</th>
            <th>Type</th>
            <th>Date</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="plannerTable"></tbody>
      </table>
    </div>
  </div>

  <div id="outputsPage" class="hidden">
    <div class="card" style="margin-top:16px">
      <div style="display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap;">
        <div>
          <h3 style="margin:0">Support Page</h3>
          <div class="muted small">How to read confidence scores, labels, and where to get help.</div>
        </div>
      </div>

      <div class="section" style="margin-top:12px;">
        <h4>Color key</h4>
        <div class="legend-grid">
          <div class="legend-item"><span class="badge green">processed</span> Completed processing</div>
          <div class="legend-item"><span class="badge yellow">processing</span> OCR in progress</div>
          <div class="legend-item"><span class="badge red">error</span> Processing error</div>
          <div class="legend-item"><span class="pill status-smart">smart</span> High-confidence extraction</div>
          <div class="legend-item"><span class="pill status-manual">manual</span> Manually entered</div>
          <div class="legend-item"><span class="pill status-inconclusive">inconclusive</span> Low confidence</div>
          <div class="legend-item"><span class="pill event-type event-effective">effective</span> Key date</div>
          <div class="legend-item"><span class="pill event-type event-renewal">renewal</span> Renewal timeline</div>
          <div class="legend-item"><span class="pill event-type event-termination">termination</span> Termination date</div>
          <div class="legend-item"><span class="pill event-type event-auto_opt_out">auto opt-out</span> Notice deadline</div>
        </div>
      </div>

      <div class="section" style="margin-top:12px;">
        <h4>Confidence scores</h4>
        <p class="muted small">
          Each extracted term includes a confidence score between 0.00 and 1.00. A score of 0.75 means the OCR model
          is about 75% confident in the value. It is close, but still needs a quick human review before you rely on it.
        </p>
        <ul class="small" style="margin:8px 0 0 18px; color:#374151;">
          <li><b>0.90+</b> — High confidence. Typically safe to accept with a fast spot check.</li>
          <li><b>0.70–0.89</b> — Medium confidence. Review the source text to confirm.</li>
          <li><b>Below 0.70</b> — Low confidence. Treat as inconclusive and verify or update manually.</li>
        </ul>
      </div>

      <div class="section">
        <h4>Status labels</h4>
        <div class="row wrap" style="gap:8px;">
          <span class="pill status-smart">smart</span>
          <span class="pill status-manual">manual</span>
          <span class="pill status-inconclusive">inconclusive</span>
        </div>
        <p class="muted small" style="margin-top:6px;">
          <b>Smart</b> indicates OCR extraction with higher confidence. <b>Manual</b> means a user entered or confirmed the term.
          <b>Inconclusive</b> flags lower-confidence values that should be reviewed.
        </p>
      </div>

      <div class="section">
        <h4>Adjusting results</h4>
        <p class="muted small">
          Use the Terms panel in Contract Detail to edit values, change the status, or add missing terms. Updating a term to
          <b>manual</b> is the best way to confirm a value after review. If a term is incorrect, edit the value and save it to
          override the OCR output.
        </p>
        <p class="muted small" style="margin-top:6px;">
          You can also add or edit Events to align renewal dates, terminations, or notice deadlines that the OCR may have missed.
        </p>
      </div>

      <div class="section">
        <h4>Reminder scheduling & email setup</h4>
        <p class="muted small">
          Reminders are configured per event from <b>Contract Detail → Events</b>. Use the <b>Emails</b> field to add recipients
          as comma-separated addresses (for example: <code>legal@company.com, ops@company.com</code>). Use the
          <b>Offsets</b> field to define when reminders are sent relative to the event date.
        </p>
        <ul class="small" style="margin:8px 0 0 18px;">
          <li><b>Offsets are in days before the event date.</b> An offset of <b>30</b> means the reminder sends 30 days before the event.</li>
          <li>Use multiple offsets to send multiple reminders (for example: <b>90, 60, 30, 7, 1</b>).</li>
          <li><b>0</b> sends the reminder on the event date itself.</li>
          <li>Only non-negative integers are accepted.</li>
        </ul>
        <p class="muted small" style="margin-top:6px;">
          After saving, the reminder status in the event list will show the configured offsets and recipients.
        </p>
      </div>
      <div class="section">
        <h4>Page guide</h4>
        <p class="muted small">
          Use this quick guide to understand what each area of the app is for and how to navigate it.
        </p>
        <ul class="small" style="margin:8px 0 0 18px;">
          <li><b>Contracts</b> — Review recent uploads, open a contract detail view, edit terms, and manage events.</li>
          <li><b>All Contracts</b> — Search, filter, and export the full contract list across all statuses.</li>
          <li><b>Events</b> — Track renewal, termination, effective, and notice dates by month or across all months.</li>
          <li><b>Planner</b> — Add or adjust events on a calendar grid to keep renewal timelines organized.</li>
          <li><b>Support Page</b> — Reference color meanings, confidence guidance, and workflow tips.</li>
        </ul>
      </div>
      <div class="section">
        <h4>Support</h4>
        <p class="muted small">Questions or issues? Email <a href="mailto:<PLACEHOLDERFOREMAIL>"><PLACEHOLDERFOREMAIL></a>.</p>
      </div>
    </div>
  </div>

  <div id="modalOverlay" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-slate-900/50 px-4" aria-hidden="true">
    <div class="w-full max-w-lg rounded-2xl border border-slate-200 bg-white p-6 shadow-xl">
      <div class="flex items-start justify-between gap-4">
        <div>
          <h3 id="modalTitle" class="text-lg font-semibold text-slate-900">Confirm action</h3>
          <p id="modalMessage" class="mt-2 text-sm text-slate-600"></p>
        </div>
        <button id="modalClose" class="text-xl text-slate-400 hover:text-slate-600" aria-label="Close dialog">×</button>
      </div>
      <div class="mt-6 flex flex-wrap justify-end gap-3">
        <button id="modalCancel" class="rounded-lg border border-slate-200 px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-50">Cancel</button>
        <button id="modalConfirm" class="rounded-lg bg-indigo-600 px-4 py-2 text-sm font-semibold text-white hover:bg-indigo-500">Confirm</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
